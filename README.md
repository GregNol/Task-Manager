# Task-Manager

## Техническое задание 

**Название:** "Мини-система управления задачами (Task Manager)"

**Цель:** Разработать прототип системы для учета задач. Задание проверяет понимание ООП, работу с базой данных, умение структурировать код и логически мыслить.

**Время выполнения:** 2-3 часа.

---

### Задание

Реализуйте простую систему управления задачами с помощью Python. Система должна позволять:

1.  **Создавать задачи.** У каждой задачи есть:
    *   Уникальный идентификатор (id)
    *   Заголовок (title)
    *   Описание (description)
    *   Статус (status): "todo", "in_progress", "done"
    *   Дата создания (created_at)
    *   (Опционально) Дата последнего обновления (updated_at)

2.  **Получать список всех задач.**
3.  **Обновлять статус задачи** (например, из "todo" в "in_progress").
4.  **Удалять задачу.**
5.  **Фильтровать задачи по статусу.**

**Технические требования:**

*   Используйте **ООП подход**. Должен быть класс `Task`, представляющий собой задачу, и класс `TaskManager`, который управляет задачами (создание, чтение, обновление, удаление).
*   Для хранения данных используйте любую **базу данных** (можно SQLite). Работа с БД должна быть реализована посредством "менеджера хранилища (storage)", который внутри себя скрывает сами sql-запросы и предоставляет удобные методы для работы с данными. Обращения к СУБД могут быть как и через движок (например, sqlite3), так и через orm-библиотеку (SQLAlchemy)
*   Не нужно делать графический интерфейс или телеграм-бота. Вся работа с системой должна быть продемонстрирована через код в функции `main()` или в отдельных вызовах методов. Можно сделать cli-приложение, но на это время тратить необязательно.
*   **Главное требование**: код должен быть чистым, читаемым и хорошо структурированным.

***Подсказки***
1. Код репозитория БД и как он примерно должен выглядеть/работать можно посмотреть в одном из наших существующих проектов, например: https://github.com/bmstu-itstech/bmstu-direct/blob/main/services/db/storage.py

2. Будет плюсом, если статусы будут являться Enum

3. Будет плюсом вынести все чувствительные данные в .env файлик (условно, данные для подключения к БД)

4. Будет плюсом, если загрузите код на github-репозиторий, в таком случае будьте внимательны и не лейте туда ничего ненужного

5. По всем вопросам можно писать мне в лс :)

## Описание решения

## Архитектура и структура проекта

Ключевые папки и файлы:

- `core/` — доменные модели и бизнес-логика (например, `core/domain/task.py`, `core/domain/status.py`).
- `services/db/` — слой доступа к данным (ORM-модели, пул подключений и `TaskManager` в `storage.py`).
- `test.py` — простой скрипт-демонстрация использования `TaskManager`.
- `config.py` — чтение конфигурации через pydantic (использует `.env`).

Цели разделения слоёв:
- `core` содержит чистую доменную модель (без зависимостей от SQLAlchemy).
- `services.db` скрывает детали хранения и предоставляет чистый API (create/get/update/delete) в виде `TaskManager`.

В файле .env хранится информация о базе данных отдельно вне основного кода

### Использумые библиотеки

1. sqlalchemy - библиотека для работы с БД с применением orm. Позволяет применять созданную структуру внезависимости от выюранной СУБД.
2. dataclasses для более читабельного описания структуры классов.
3. pydantic для отделения переменных среды (.env файл)

### Пример

В файле test.py приведен пример взаимодействия менеджером задач и со всем его функционалом

## Быстрый старт

Ниже — минимальные шаги, чтобы запустить проект локально на Windows (PowerShell).

1) Создайте и активируйте виртуальное окружение (рекомендуется):

```powershell
python -m venv .venv
.\.venv\Scripts\Activate.ps1
```

2) Установите зависимости:

```powershell
python -m pip install --upgrade pip
python -m pip install -r requirements.txt
# Для локальной работы с sqlite в asyncio обязательно
python -m pip install aiosqlite
```

3) Создайте файл `.env` в корне проекта и укажите строку подключения к БД.
Пример для локального sqlite (файл `./task_manager.db`):

```
DB_URI=sqlite+aiosqlite:///./task_manager.db
```

4) Запустите демонстрацию в `test.py`:

```powershell
.\.venv\Scripts\python.exe .\test.py
```

После запуска `test.py` вы увидите шаги создания, получения, обновления и удаления задачи — это демонстрация всех методов `TaskManager`.

## Примечания по БД

- Для удобства разработки проект использует SQLite; для асинхронной работы SQLAlchemy требует async-драйвер (например, `aiosqlite`).
- В `services/db/models.py` модели определены с учётом работы с SQLAlchemy ORM; при использовании sqlite важно, чтобы первичные ключи и последовательности были определены корректно (в SQLite работает автогенерация целочисленных PK).

Если вы используете другую СУБД (Postgres/MySQL), используйте соответствующий async-драйвер и корректную строку подключения, например:

- PostgreSQL (asyncpg): `postgresql+asyncpg://user:pass@host:5432/dbname`

Не забудьте установить драйвер:

```powershell
python -m pip install asyncpg
```

## Тестирование и отладка

- `test.py` — быстрая ручная проверка поведения CRUD-операций.
- Для unit-тестов можно добавить тесты на `services/db/storage.py` (mock-сессия или тестовая база sqlite в памяти).

Советы при отладке ошибок с SQLAlchemy/aiosqlite:
- Убедитесь, что URI содержит `+aiosqlite` при использовании sqlite.
- Если видите ошибку про `NOT NULL constraint failed: tasks.id`, проверьте модель `services/db/models.py` — поле `id` должно быть целочисленным PK с автогенерацией (в SQLite часто достаточно Column(Integer, primary_key=True)).

## Контрибьюция и улучшения

Если вы хотите развивать проект:

- Добавить unit-тесты для CRUD (pytest + pytest-asyncio).
- Разделить конфигурацию окружения (например, добавить `docker-compose` для Postgres).
- Добавить CLI или минимальный HTTP API для удобного взаимодействия.

Если у вас есть идеи — создавайте pull request или открывайте issue.

## Лицензия

Проект хранит лицензию в файле `LICENSE`.
